<div class="card eventscard">
	<div class="card-body text-center pt-0 h-100 overflow">
		<div class="row justify-content-center">
			<div class="col-md-2 text-start">
				<p-button (click)="goBack()" icon="pi pi-arrow-left" class="btn-rounded"
					class="p-button-rounded p-button-text text-dark"></p-button>
			</div>
			<div class="col-md-8 text-center">
				<h5 class="select-title mb-1" tooltipPosition="right"
					pTooltip="Questions related to the application process are answered">{{ type == "recent" ? "Recently
					Added" : "Most Popular" }} Questions<i class="questiontooltip fa-solid fa-circle-question"></i></h5>
			</div>
			<div class="col-md-2"></div>
		</div>
		<div class="row">
			<div *ngFor="let sub of listQuestions; let i = index" class="col-lg-3 col-md-4 col-sm-4 col-xs-6 col-6">
				<div class="row w-100 h-100 m-0 justify-content-center">
					<div (click)="onQuestionClick(sub)"
						class="card questioncard {{ sub.read == 1 ? 'questionread' : '' }}">
						<div class="card-body px-0 d-flex justify-content-between flex-column">
							<div class="row justify-content-center">
								<div class="col">
									<p class="text-start fw-medium questiontext">{{ sub.question }}</p>
								</div>
								<!--<div class="col-md-4 text-center">
                                           <p class="mb-3 circle text-center">{{i+1}}</p>
                                       </div> -->
								<div class="col-md-3 text-end" *ngIf="sub.popular == 1">
									<i class="pi pi-star-fill text-danger" pTooltip="Most Popular Question"
										tooltipPosition="right" style="font-size: 1.5rem"></i>
								</div>
							</div>
							<button class="btn btn-rounded w-full btn-primary m-0 primary-btn
                                        {{ sub.read == 1 ? 'readButton' : '' }}" pButton type="button">
								Read Answer
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="event-paginator" style="background-color: #fff; border-radius: 0px 0px 15px 15px">
	<p-paginator [rows]="10" [totalRecords]="listQuestionCount" (onPageChange)="paginate($event)"
		[rowsPerPageOptions]="[10, 32, 72, 100]"></p-paginator>
</div>

<p-dialog [(visible)]="isQuestionAnswerVisible" [draggable]="false" [modal]="true" class="questionmodal" header="Header"
	[maximizable]="true" [style]="{ height: '80vh' }">
	<ng-template pTemplate="header">
		<div class="d-flex flex-column w-100 px-4 mb-4">
			<div>
				<h5 class="select-title text-center mb-3">{{ currentModuleName }} - {{ moduleName }}</h5>
				<span class="text-xl font-bold"></span>
			</div>
			<div>
				<p-breadcrumb [model]="breadCrumb" class="max-w-full"></p-breadcrumb>
			</div>
			<div class="d-flex justify-content-between align-items-center">
				<div>
					<button (click)="goToHome($event)" class="btn btn-primary homecardbtn m-0 px-4 py-2">
						<i class="fa-solid h5 fa-house"></i><br />
						Home
					</button>
				</div>
				<div class="d-flex">
					<a role="button" *ngIf="isAnswerDialogVisiblePrev" (click)="clickPrevious(carousel, $event)"> <i
							class="text-green h4 mx-3 mb-0 fa-solid fa-circle-chevron-left"></i></a>
					<p class="mb-0 fw-semibold">Question Number {{ selectedQuestion + 1 }}</p>
					<a role="button" *ngIf="isAnswerDialogVisibleNext" (click)="clickNext(carousel, $event)"><i
							class="text-green mx-3 h4 fa-solid mb-0 fa-circle-chevron-right"></i></a>
				</div>
				<div>
					<button (click)="openReport()" class="btn btn-primary homecardbtn my-0 px-4 py-2 mx-0">
						<i class="fa-solid h5 fa-file-contract"></i>
						<br />
						Report
					</button>
					<button style="display: none" (click)="reviewBy()"
						class="btn btn-primary homecardbtn my-0 px-4 py-2">
						<i class="fa-regular fa-user h5"></i><br />
						Reviewed By
					</button>
				</div>
			</div>
		</div>
	</ng-template>
	<div class="carousel-container px-4">
		<p-carousel #carousel (onPage)="setPage($event)" [circular]="true" [numScroll]="1" [numVisible]="1"
			[page]="selectedQuestion" [responsiveOptions]="responsiveOptions" [value]="listQuestions"
			class="answersection">
			<ng-template [ngForOf]="listQuestions" let-i="index" let-val ngFor pTemplate="item">
				<div class="card answercard">
					<div class="card-body text-start">
						<p class="text-small blockquote text-start mb-0">Last updated at: {{ val.updated_at | date }}
							<span class="badge"
								style="background-color: {{val.pre_verified == 1 ? 'darkorchid' : '#3f4c83'}};">
								{{val.pre_verified == 1 ? 'Pre Verified' : 'Non Pre-Verified'}}</span></p>
						<h3 class="unselectable">{{ val.question }}</h3>
						<div class="fw-medium worksans unselectable" style="white-space: pre-wrap"
							[innerHTML]="val.answer"></div>
					</div>
				</div>
			</ng-template>
		</p-carousel>
	</div>
	<ng-template pTemplate="footer">
		<div class="d-flex justify-content-between flex-column flex-md-row px-4 my-4">
			<div class="flex-full" *ngIf="videoLinks">
				<h5 class="text-start">Recommended Videos</h5>
				<div class="d-flex flex-wrap gap-2" id="ref-links-container">
					<a class="px-4 m-0 py-2 btn btn-primary btn-rounded" target="_blank" href="{{ videoL.link }}"
						*ngFor="let videoL of videoLinks; let ind = index">Video {{ ind + 1 }} &nbsp;<i
							class="fa-solid fa-video"></i></a>
				</div>
			</div>
			<div class="flex-full" *ngIf="refLink">
				<h5 class="text-start">Recommended Links</h5>
				<div class="d-flex flex-wrap gap-2" id="ref-links-container">
					<a class="px-4 m-0 py-2 btn btn-secondary btn-rounded" target="_blank" href="{{ refL.link }}"
						*ngFor="let refL of refLink; let ind = index">Link {{ ind + 1 }} &nbsp;<i
							class="fa-solid fa-link"></i></a>
				</div>
			</div>
			<div class="flex-shrink-0 align-items-center d-flex">
				<button class="btn w-100 btn-primary homecardbtn mx-0 px-5 py-2" (click)="onClickAsk()">
					<i class="h5 fas fa-comment"></i>
					<br />
					Click here to ask<br />Personalised Questions
				</button>
			</div>
		</div>
	</ng-template>
</p-dialog>

<p-dialog [(visible)]="isRecommendedVideoVisible" class="questionvideopopup" [modal]="true" [style]="{ width: '80vw' }">
	<div class="container-fluid">
		<div class="row justify-content-center align-items-center">
			<div class="col-md-1" *ngIf="videoLinks">
				<a (click)="clickPreviousVideoPopup($event)"><i
						class="text-green h4 mx-3 mb-0 fa-solid fa-circle-chevron-left"></i></a>
			</div>
			<div class="col-md-10">
				<p-carousel #carouselPopupVideoElm [circular]="false" [showNavigators]="false" [showIndicators]="false"
					[numScroll]="1" [numVisible]="1" [page]="selectedVideo" [responsiveOptions]="responsiveOptions"
					[value]="videoLinks" *ngIf="videoLinks">
					<ng-template let-item pTemplate="item">
						<div class="border-1 surface-border border-round m-2 text-center">
							<div class="mb-1">
								<iframe
									allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
									allowfullscreen class="mb-2" frameborder="0" height="500px " [src]=""
									title="YouTube video player" width="100%"></iframe>
							</div>
						</div>
					</ng-template>
				</p-carousel>
			</div>
			<div class="col-md-1" *ngIf="videoLinks">
				<a (click)="clickNextVideoPopup($event)"><i
						class="text-green mx-3 h4 fa-solid mb-0 fa-circle-chevron-right"></i></a>
			</div>
		</div>
	</div>
</p-dialog>

<p-dialog [(visible)]="isRecommendedLinksVisible" [draggable]="false" [modal]="true" [style]="{ width: '30vw' }"
	header="Header">
	<ng-template pTemplate="header">
		<span class="text-xl font-bold"></span>
	</ng-template>
	<div class="container-fluid">
		<!-- <div class="row">
            <div class="col-md-12 col-lg-12" *ngFor="let link of refLink">
                <img src="link.image" height="100" width="100" [alt]="link.image" class="w-2 shadow-2"/>
            </div>
        </div> -->
		<div class="row justify-content-center align-items-center">
			<div class="col-md-2" *ngIf="refLink">
				<a (click)="clickPreviousRefPopup($event)"><i
						class="text-green h4 mx-3 mb-0 fa-solid fa-circle-chevron-left"></i></a>
			</div>
			<div class="col-md-8">
				<p-carousel #carouselPopupRefElm [circular]="false" [numScroll]="1" [numVisible]="1"
					[responsiveOptions]="responsiveOptions" [value]="refLink" *ngIf="refLink" [page]="selectedRefLink">
					<ng-template let-item pTemplate="item">
						<div class="border-1 surface-border border-round m-2 text-center">
							<div class="mb-1">
								<img src="{{ item.link }}" [alt]="item.link" class="w-2 shadow-2 img-fluid" />
								<!-- <video controls height="100" width="100">
                                                <source src="item.reflink" type="video/mp4">
                                                <source src="item.reflink" type="video/ogg">
                                                Your browser does not support HTML video.
                                            </video> -->
							</div>
						</div>
					</ng-template>
				</p-carousel>
			</div>
			<div class="col-md-2" *ngIf="refLink">
				<a (click)="clickNextRefPopup($event)"><i
						class="text-green mx-3 h4 fa-solid mb-0 fa-circle-chevron-right"></i></a>
			</div>
		</div>
	</div>
</p-dialog>

<p-dialog [(visible)]="isReviewedByVisible" [draggable]="false" label="Show" [modal]="true" [maximizable]="true"
	[style]="{ width: '30vw' }" header="Header">
	<ng-template pTemplate="header">
		<span class="text-xl font-bold ms-2">Reviewed</span>
	</ng-template>
	<div class="container-fluid">
		<div class="row justify-content-center align-items-center">
			<div class="col-md-3" *ngFor="let review of reviewedByOrgList">
				<img src="{{ review.logo }}" [alt]="review.organizationname" class="w-2 shadow-2 img-fluid" />
			</div>
		</div>
	</div>
</p-dialog>