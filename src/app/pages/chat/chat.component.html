<div class="col-md-12">
  <p-card class="col-12" >
    <ng-template pTemplate="header">
      <span style="float: right">
        <p-overlayPanel #op>
          <form
            [formGroup]="filterForm"
            (ngSubmit)="filtersubmit()"
            #filterFormElm
          >
            <div class="col-md-12 mt-1">
              <div class="form-group">
                <label>Report Issues</label>
                <p-dropdown
                  formControlName="reportOption"
                  optionValue="id"
                  optionLabel="reportoption_name"
                  styleClass="w-full"
                  [options]="reportOptions"
                ></p-dropdown>
              </div>
            </div>
            <br />
            <div class="col-md-12 mt-1">
              <div class="form-group">
                <label>Add Comment</label>
                <textarea
                  rows="3"
                  cols="35"
                  styleClass="w-full"
                  pInputTextarea
                  formControlName="comment"
                ></textarea>
              </div>
            </div>

            <div class="row mt-3 mt-1">
              <button
                class="ps-3 pe-3 pt-2 pb-2"
                pButton
                type="submit"
                style="
                  background-color: var(--uniprep-primary);
                  border-radius: 8px;
                  border: aliceblue;
                  color: #fff;
                "
                label="Submit"
              ></button>
            </div>
          </form>
        </p-overlayPanel>
        <button class="btn btn-light" (click)="op?.toggle($event)">
          Report
        </button>

        <button class="btn btn-light" routerLink="/pages/guideline">
          Chat Guidlines
        </button></span
      >
      <span class="text-right credits"
        >Question Credits <span class="credits-span">{{ totalcredits }}</span>
      </span>
      <span class="chatwindow" (click)="previouspage()"
        ><i class="fa fa-arrow-left"></i
      ></span>
      <span
        style="
          font-size: 0.9rem;
          float: right;
          line-height: normal;
          margin-right: 7rem;
        "
        >UNIPREP<br />
        <!-- <span style="font-size: 0.8rem">support@uniabroad.co.in</span> -->
      </span>
      <span style="float: right">
        <img
          src="../../../uniprep-assets/images/chatimage.png"
          style="
            border-radius: 50%;
            height: 35px;
            width: 35px;
            object-fit: none;
            margin-right: 0.5rem;
            background-color: white;
          "
        />
      </span>
    </ng-template>
    <ng-template pTemplate="body">
      <section class="chat">
        <div *ngFor="let message of messages; let index = index">
          <div class="chat-section-container" *ngIf="message?.questionNumber">
            <div class="chat-section mb-2">
              <div class="photo receiver-bg">
                <ng-container *ngIf="message?.countryFlag">
                  <span class="countryimage"
                    ><img [src]="message?.countryFlag"
                  /></span>
                </ng-container>
                <ng-container *ngIf="!message?.countryFlag">
                  <span class="name">
                    {{ message.sendByName.slice(0, 1) }}</span
                  >
                </ng-container>
              </div>
              <div>
                <span class="full-name">{{ message.sendByName }}</span
                ><br />
                <span class="msg-info"
                  >Post Application | {{ message.sendDateTime }}</span
                >
              </div>
            </div>
            <span class="msg-info" style="padding-left: 3rem"
              >Question {{ message.questionNumber }}</span
            ><br />
            <div class="chat-section msg-bottom">
              <div class="messages" [innerHTML]="message.message"></div>
            </div>
          </div>
          <div
            class="chat-section-container"
            style="display: flex"
            *ngIf="message.answerForQuestion"
          >
            <div class="msg-bottom">
              <div class="response">
                <div class="chat-section mb-2">
                  <div class="photo sender-bg">
                    <span class="name">{{
                      message.sendByName.slice(0, 1)
                    }}</span>
                  </div>
                  <div>
                    <span class="full-name">{{ message.sendByName }}</span>
                  </div>
                </div>
                <div>
                  <span class="msg-info"
                    >Replying for Question {{ message.answerForQuestion }}</span
                  ><br />
                  <p class="response-msg-question" [innerHtml]=getData(message.answerForQuestion)></p>
                 <p
                      *ngIf="message.message"
                      class="response-msg"
                      [innerHtml]="message.message"
                    ></p>
                    <p *ngIf="message.attachment" [pTooltip]=message.filename class="response-msg-attach"><label>{{ message.filename }}</label> &nbsp;&nbsp;<a 
                    [href]="
                      message.attachment
                    "
                    ><i class="pi pi-arrow-circle-down"></i>
                      </a></p>
                </div>
              </div>
            </div>
          </div>
        </div></section
    ></ng-template>
    <ng-template pTemplate="footer">
      <div class="field col-12" [class]="fullscreen" #fullscreeneditor>
      <p-editor
        [(ngModel)]="textMessage"
        [style]="{ height: '100px' }"
        [modules]="modules"
        >
        <ng-template pTemplate="header" style="visibility: hidden;"></ng-template>
      </p-editor
      >
      <br />
      <div class="text-end">
        <button
          (click)="confirm($event)"
          class="btn text-white"
          style="
            background-color: #3f4c83;
            height: 35%;
            width: 15%;
            font-size: medium;
          "
        >
          Send Message
        </button>
      </div></div>
    </ng-template></p-card
  >
  <p-dialog
    [visible]="visibility"
    [closable]="false"
    [modal]="true"
    [style]="{ width: '20vw' }"
  >
    <div
      style="
        background: #3f4c83 !important;
        border-radius: 50% !important;
        height: 25px !important;
        width: 25px !important;
        position: absolute;
        right: -10px;
        top: -10px;
        text-align: center;
        cursor: pointer;
      "
      (click)="visibility = !visibility"
    >
      <i style="color: #fff" class="fa fa-close"></i>
    </div>
    <div class="row mt-1">
      <div
        class="col-2"
        style="align-self: center; padding-left: 30px; padding-bottom: 25px"
      >
        <span
          style="
            color: white;
            text-align: center;
            vertical-align: middle;
            background-color: #3f4c83;
            border-radius: 50%;
          "
          ><i style="height: 25px; width: 25px" class="fa fa-info"></i
        ></span>
      </div>
      <div
        class="col-10 mb-4"
        style="font-size: 14px; font-weight: 600; vertical-align: middle"
      >
        Thank you for reaching out to us.<br />
        Please anticipate a response within<br />
        8 working hours
      </div>
    </div>
  </p-dialog>
  <p-confirmPopup></p-confirmPopup>
</div>
