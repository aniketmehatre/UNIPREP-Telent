<div class="card readingcard">
	<ng-container *ngIf="!enableModule">
		<div class="d-flex justify-content-center">
			<div class="col-md-6 text-center">
				<div class="select-title text-nowrap d-flex justify-content-between align-items-center">
					<div>
						<h5 class="w-100 mb-0" tooltipPosition="top" pTooltip="Investor List">INVESTOR LIST<i class="questiontooltip fa-solid fa-circle-question"></i></h5>
					</div>
					<div>
						<button class="how-it-works-button" (click)="openVideoPopup('https://www.youtube.com/embed/dVAzK2cBCyA?si=ApmnymiuiK0wOgwv')">&nbsp;How it works? &nbsp;&nbsp;<i class="fa-solid fa-play"></i></button>
					</div>
				</div>
			</div>
		</div>
		<div class="carousel-container">
			<p-carousel [value]="recommendations" [numVisible]="1" [numScroll]="1" [circular]="false" [showNavigators]="false" [showIndicators]="false" [page]="activePageIndex" styleClass="h-100">
				<ng-template let-recommendation let-i="index" pTemplate="item">
					<div class="d-flex flex-column justify-content-between" style="height: 63vh;">
						<div class="product-item">
							<div class="product-item-content">
								<div class="p-mb-3"></div>
								<div class="text-center">
									<p class="question-number p-2">Question Number {{ recommendation.id }}</p>
									<h4 class="p-mb-1 question p-2">{{ recommendation.question }}</h4>
								</div>
								<div class="check-list mt-5">
									<div class="align-items-center">
										<ng-container *ngIf="recommendation.id == 1">
											<div class="cube-container">
												<div *ngFor="let cube of investorType" class="cube"  (click)="selectCube(1, cube.id)" 
													[ngClass]="{'selected': selectedData[1]?.includes(cube.id)}">
												  <label>{{ cube.investor_type_name }}</label>
												  <i class="fa-solid fa-circle-check tickPlacement" *ngIf="selectedData[1]?.includes(cube.id)"></i>
												</div>
											  </div>
											  <p class="text-center" [ngClass]="{ 'd-none': invalidClass === false }" 
											  style="color: red">Please Choose Any one option<p>											  
										</ng-container>
										<ng-container *ngIf="recommendation.id == 2">
											<p-multiSelect styleClass="w-100" placeholder="Investor Country" [options]="countryList" (onChange)="loadHeadQuartersData($event)" display="chip" optionLabel="country" optionValue="id" [(ngModel)]="selectedData[recommendation.id]" [appendTo]="'body'"></p-multiSelect>
											<p class="text-center" [ngClass]="{ 'd-none': invalidClass === false }" style="color: red">Please Choose Any one option</p>
										</ng-container>
										<ng-container *ngIf="recommendation.id == 3">
											<p-multiSelect styleClass="w-100" placeholder="Headquarters Location" [options]="anyHeadquartersList" display="chip" optionLabel="head_quarters_name" optionValue="id" [(ngModel)]="selectedData[recommendation.id]" [appendTo]="'body'"></p-multiSelect>
											<p class="text-center" [ngClass]="{ 'd-none': invalidClass === false }" style="color: red">Please Choose Any one option</p>
										</ng-container>
									</div>
								</div>
							</div>
						</div>
						<div class="d-flex justify-content-between p-3">
							<button pButton type="button" class="text-white p-ripple p-button-rounded p-button-info-prev p-button p-component p-2" [style.visibility]="recommendation.id == 1 ? 'hidden' : 'visible'" (click)="previous()" ><i class="fa fa-arrow-left exhausted-plan-icon-prev"></i> Previous</button>
							<button pButton type="button" (click)="next(recommendation.id)" *ngIf="recommendation.id != 3" class="text-white p-ripple p-button-rounded p-button-info-next p-button p-component p-2">Next <i class="fa fa-arrow-right exhausted-plan-icon-next" ></i></button>
							<button pButton type="button" (click)="getRecommendation()" *ngIf="recommendation.id == 3" class="text-white p-ripple p-button-rounded p-button-info-succes p-button p-component p-2" >Get Recommendations<i class="fa fa-check-circle exhausted-plan-icon-success"></i></button>
						</div>
					</div>
				</ng-template>
			</p-carousel>
		</div>
	</ng-container>
	<ng-container *ngIf="enableModule">
		<div class="card-body pt-0">
			<div class="row justify-content-center" *ngIf="!restrict">
				<div class="col-md-3 text-start">
					<div class="p-input-icon-left w-100 mt-3">
						<i class="pi pi-search"></i>
						<input class="w-100 px-5 py-2" type="text" placeholder="Search in Investor List" pInputText [(ngModel)]="valueNearYouFilter" (input)="performSearch($event)" />
					</div>
					<span class="d-flex justify-content-start p-2" style="white-space: nowrap">
						<input type="checkbox" class="me-0" style="transform: scale(1.5);cursor: pointer;" [(ngModel)]="selectAllCheckboxes" (click)="selectAllCheckbox()" id="selectAllcheckbox" />
						<label class="p-2" for="selectAllcheckbox" style="cursor: pointer;">Select All</label>
						<span class="p-2">Selected : {{ selectedInvestors }}</span>
						<button class="btn btn-primary text-small" (click)="viewFavourites()" type="button">
							{{ viewFavouritesLabel }}<span class="favCount" *ngIf="viewFavouritesLabel != 'View All'">{{ favCount }}</span>
						</button>
					</span>
				</div>
				<!-- after create the video just uncomment the below code. and send the youtube embeded video link -->
				<!-- <div class="col-md-6 text-center">
					<h5 class="select-title mb-1" tooltipPosition="top" pTooltip="Investor List">INVESTOR LIST</h5>
				</div> -->
				<div class="col-md-6 text-center">
					<div class="select-title text-nowrap d-flex justify-content-between align-items-center">
						<div>
							<h5 class="w-100 mb-0" tooltipPosition="top" pTooltip="Investor List">INVESTOR LIST<i class="questiontooltip fa-solid fa-circle-question"></i></h5>
						</div>
						<div>
							<button class="how-it-works-button" (click)="openVideoPopup('https://www.youtube.com/embed/dVAzK2cBCyA?si=ApmnymiuiK0wOgwv')">&nbsp;How it works? &nbsp;&nbsp;<i class="fa-solid fa-play"></i></button>
						</div>
					</div>
				</div>
				<div class="col-md-3 text-end">
					<span class="d-flex justify-content-end mt-3 gap-2" style="white-space: nowrap">
						<button class="btn btn-primary text-small investor-guidlines" (click)="investorGuidlines()" type="button">Investor Guidelines</button>
						<button *ngIf="ehitlabelIsShow" class="btn btn-primary text-small investor-guidlines" (click)="buyCredits()" type="button">Buy Credits</button>
						<button class="btn btn-primary text-small exportButton" (click)="exportData()" type="button">
							Export <span class="exportCount">{{ exportCreditCount }}</span>
						</button>
					</span>
					<div class="d-flex w-100 align-items-center justify-content-end p-2 gap-2" style="white-space: nowrap">
						<button class="btn btn-primary text-small ps-3 pe-3 pt-2 pb-2 br-8 p-1" style="background-color: #ff9113 !important" (click)="openReport()" type="button">Report</button>
						<div class="pe-2">
							<span class="text-muted text-small"
								><strong>Total Investors : {{ totalInvestorsCount }}</strong></span
							>
						</div>
						<button class="btn btn-primary text-small ps-3 pe-3 pt-2 pb-2 br-8" (click)="filterBy()" type="button">Filter by</button>
					</div>
				</div>
			</div>
			<div class="container-fluid" *ngIf="!restrict">
				<div class="row">
					<div *ngFor="let investorListData of investorData" class="col-md-3 col-12 mt-3">
						<div class="card investorcard h-100">
							<div class="card-body d-flex flex-column justify-content-between">
								<div class="d-flex justify-content-between align-items-start">
									<div class="d-flex gap-2 align-items-start">
										<input type="checkbox" (change)="onCheckboxChange($event)" class="mt-1" style="transform: scale(1.5)" [(ngModel)]="investorListData.isChecked" />
										<h5 class="uniprep-primary" title="Investor Name">{{ investorListData.org_name }}</h5>
									</div>
	
									<i [class]="investorListData.favourite == 1 ? 'fa-solid fa-bookmark' : 'fa-regular fa-bookmark'" style="color: #e90707" (click)="bookmarkQuestion(investorListData.id, investorListData.favourite)"></i>
								</div>
								<div>
									<div class="d-flex mt-2 gap-5 align-items-center">
										<div class="d-flex gap-2 align-items-center" title="Inverstor Country">
											<i class="fa-solid fa-location-dot locationicon" aria-hidden="true"></i>
											<p class="text-small mb-0">{{ investorListData.country }}</p>
										</div>
										<div class="d-flex gap-2 align-items-center" title="Investor Headquarters">
											<i class="fa-solid fa-building countryicon" aria-hidden="true"></i>
											<p class="text-small mb-0">{{ investorListData.head_quarters }}</p>
										</div>
									</div>
									<div class="d-flex mt-2 gap-5 align-items-center justify-content-between">
										<div class="d-flex gap-2 align-items-center" title="Investor Type">
											<i class="fa-solid fa-list investoricon" aria-hidden="true"></i>
											<p class="text-small text-break mb-0">{{ investorListData.investor_type }}</p>
										</div>
										<div class="gap-3 d-flex justify-content-end">
											<div *ngIf="investorListData.website && investorListData.website.trim() !== ''">
												<a target="_blank" href="{{ !investorListData.website.startsWith('http://') && !investorListData.website.startsWith('https://') ? 'http://' + investorListData.website : investorListData.website }}"><i class="fa-solid fa-globe pr-2"></i></a>
											</div>
											<div *ngIf="investorListData.email && investorListData.email.trim() !== ''">
												<a target="_blank" href="mailto:{{ investorListData.email }}"><i class="fa-solid fa-envelope mailicon pr-2"></i></a>
											</div>
											<div *ngIf="investorListData.linked_in && investorListData.linked_in.trim() !== ''">
												<a target="_blank" href="{{ investorListData.linked_in }}"><i class="fa-brands fa-linkedin uniprep-primary"></i></a>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div *ngIf="totalInvestorsCount == 0" class="text-center margin-auto">
					<h3>No Results Found</h3>
					<p>
						The applied filter did not provide any results,<br />
						please try again by changing the parameters.
					</p>
				</div>
			</div>
	
			<p-paginator *ngIf="totalInvestorsCount != 0" [rows]="pageSize" [totalRecords]="totalInvestorsCount" (onPageChange)="pageChange($event)" [rowsPerPageOptions]="[50, 100, 300, 500, 1000]"></p-paginator>
			<div class="text-align-right d-flex justify-content-end" >
				<button pButton type="button" class="text-black b-none p-ripple p-button-rounded p-danger-button p-button p-component p-2 bg-white" (click)="resetRecommendation()">
					Reset Recommendations<span class="fa-stack">
						<i class="fa fa-circle fa-stack-2x"></i>
						<i class="fa fa-undo fa-stack-1x fa-inverse"></i>
					</span>
				</button>
			</div>
			<!--		<div *ngIf="restrict" class="investor-expired">-->
			<!--			<div class="row justify-content-center">-->
			<!--				<div class="col-md-2 text-start"></div>-->
			<!--				<div class="col-md-8 text-center">-->
			<!--					<h5 class="select-title mb-1" tooltipPosition="top" pTooltip="">INVESTOR LIST</h5>-->
			<!--				</div>-->
			<!--				<div class="col-md-2"></div>-->
			<!--			</div>-->
			<!--			<div class="text-center mt-5 mb-4">-->
			<!--				<img src="../../../uniprep-assets/images/smartloack.png" class="image" width="80" />-->
			<!--				<h3>Upgrade now to access invaluable tools</h3>-->
			<!--				<p>-->
			<!--					<br />-->
			<!--					Upgrade your plan now to gain instant access.-->
			<!--				</p>-->
			<!--				<p class="offer">Investor list offers:<br />Information of over 1,00,000 investors including details about the investor name, investor type, contact details and much more!</p>-->
			<!--				<button pButton type="button" class="text-white p-ripple p-button-rounded p-button-warning p-button p-component p-2" (click)="upgradePlan()">Upgrade Plan<i class="fa fa-arrow-right exhausted-plan-icon"></i></button>-->
			<!--			</div>-->
			<!--		</div>-->
		</div>
	</ng-container>
</div>

<p-dialog header="Filter Investors" [(visible)]="isFilterVisible" [modal]="true" [style]="{ width: '60rem' }" [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [ngStyle]="{ display: isFilterVisible }">
	<div class="m-5">
		<form role="form" [formGroup]="filterForm" (ngSubmit)="loadInvestorData(0)">
			<div class="row">
				<div class="col-md-12">
					<div class="row">
						<div class="col-md-6">
							<label class="form-label" style="font-size: medium; font-weight: 500">Filter by Investor Name</label>
							<div class="form-group">
								<div class="mb-3">
									<input class="w-100" type="text" placeholder="Search Investor Name" formControlName="org_name" pInputText />
								</div>
							</div>
						</div>
						<div class="col-md-6">
							<label class="form-label" style="font-size: medium; font-weight: 500">Filter by Investor Type</label>
							<div class="form-group">
								<div class="mb-3">
									<p-multiSelect [options]="investorType" styleClass="w-100" formControlName="investor_type" optionValue="id" defaultLabel="Select Investor Type" optionLabel="investor_type_name" #InvestorTypeMultiSelect [appendTo]="'body'">
										<ng-template pTemplate="selectedItems">
											{{ InvestorTypeMultiSelect.defaultLabel }}
										</ng-template>
									</p-multiSelect>
								</div>
							</div>
						</div>
						<div class="col-md-6">
							<label class="form-label" style="font-size: medium; font-weight: 500">Filter by Country</label>
							<div class="form-group">
								<div class="mb-3">
									<p-multiSelect [options]="countryList" styleClass="w-100" formControlName="country" optionValue="id" (onChange)="loadHeadQuartersData($event)" defaultLabel="Select Countries" optionLabel="country" #multiSelect [appendTo]="'body'">
										<ng-template pTemplate="selectedItems">
											{{ multiSelect.defaultLabel }}
										</ng-template>
									</p-multiSelect>
									<div *ngIf="filterForm.hasError('org_name')" class="text-danger">
										{{ filterForm.getError("org_name") }}
									</div>
								</div>
							</div>
						</div>
						<div class="col-md-6">
							<label class="form-label" style="font-size: medium; font-weight: 500">Filter by Headquarters</label>
							<div class="form-group">
								<div class="mb-3">
									<p-multiSelect [options]="headQuartersList" styleClass="w-100" formControlName="head_quarters" defaultLabel="Select Head Quarters" optionValue="id" optionLabel="head_quarters_name" #InvestorHeadQuartersMultiSelect [appendTo]="'body'">
										<ng-template pTemplate="selectedItems">
											{{ InvestorHeadQuartersMultiSelect.defaultLabel }}
										</ng-template>
									</p-multiSelect>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div>
				<button type="submit" class="btn btn-dark w-100" style="background-color: var(--uniprep-primary); border: none">Apply Filter</button>
				<button class="btn btn-dark w-100" (click)="clearFilter()" style="background-color: white; border-radius: 8px; color: var(--uniprep-primary); border: none" type="button">Reset Filter</button>
			</div>
		</form>
	</div>
</p-dialog>

<p-dialog [(visible)]="restrict" [style]="{ width: '30vw' }" [draggable]="false" [resizable]="false" class="restrictionDialog" [breakpoints]="{ '960px': '30vw', '959px': '60vw', '425px': '90vw' }" (onHide)="clearRestriction()">
	<div *ngIf="ehitlabelIsShow" class="text-center mt-5 mb-4">
		<img src="../../../uniprep-assets/images/smartloack.png" class="image" width="60" />
		<h3 class="offer">Upgrade Required</h3>
		<p>To access this exclusive module,please upgrade your plan now</p>
		<button pButton type="button" class="text-white p-ripple p-button-rounded p-button-warning p-button p-component p-2" (click)="upgradePlan()">Upgrade Plan<i class="fa fa-arrow-right exhausted-plan-icon"></i></button>
	</div>
	<div *ngIf="!ehitlabelIsShow" class="text-center mt-5 mb-4">
        <img src="../../../uniprep-assets/images/smartloack.png" class="image" width="60"/>
        <h3 class="offer">Upgrade Required</h3>
        <p>Please contact {{orgnamewhitlabel}} Company for access</p>
    </div>
</p-dialog>
