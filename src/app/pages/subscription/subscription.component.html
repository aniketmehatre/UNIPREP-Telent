<ng-container [ngSwitch]="stage">
	<ng-container *ngSwitchCase="1">
		<ng-container *ngIf="studentType===1">
			<uni-subscription-data #applyTarget (upgrade)="start()" [history]="(orderHistory$ | async) || []" [billing]="user"
				[subscriptions]="subscriptionDetail$ | async" (subscriptionPlan)="pay($event)"
				[showHistoryBtn]="showHistoryBtn" (showHistory)="showHistory($event)" (subscriptionDataLoaded)="onSubscriptionDataLoaded($event)">
			</uni-subscription-data>
		</ng-container>
		<ng-container *ngIf="studentType===2">
			<uni-clg-subscription-data #applyTarget (upgrade)="start()" [history]="(orderHistory$ | async) || []" [billing]="user"
				[subscriptions]="subscriptionDetail$ | async" (subscriptionPlan)="pay($event)"
				[showHistoryBtn]="showHistoryBtn" (showHistory)="showHistory($event)" (subscriptionDataLoaded)="onSubscriptionDataLoaded($event)">
			</uni-clg-subscription-data>
		</ng-container>
	</ng-container>

	<ng-container *ngSwitchCase="2">
		<uni-subscription-list [whichOneVisible]="isSubOrQuestion" (selected)="onSelectSubscription($event)"
			(selectedCredit)="onSelectQuestionCredit($event)" [country]="countryList"
			[plans]="(subscriptions$ | async) || []">
		</uni-subscription-list>
	</ng-container>

	<ng-container *ngSwitchCase="3">
		<uni-subscription-billing (pay)="pay($event)" (payQuestionCredit)="payQuestionCredit()" (change)="changePlan()"
			(changeQuestionCreditPlan)="changeQuestionCreditPlan()" [loading]="(orderLoading$ | async) || false"
			[plan]="selectedSubscription" [planQuestionCredit]="selectedQuestionCredit">
		</uni-subscription-billing>
	</ng-container>

	<ng-container *ngSwitchCase="4">
		<uni-subscription-success [plan]="success">
		</uni-subscription-success>
	</ng-container>

	<ng-container *ngSwitchCase="5">
		<uni-subscription-history [userSubscription]="userSubscription" [subscribedHistoryList]="subscribedHistoryData"
			(showPlan)="showPlan($event)" [showPlanBtn]="showPlanBtn" [subscribedCountryList]="subscribedCountryList"
			[accountBillingList]="accountBillingData">
		</uni-subscription-history>
	</ng-container>

	<p-dialog  [(visible)]="cardvisibility" [style]="{ width: '40vw', height: 'auto' }" [breakpoints]="{ '960px': '50vw', '959px': '80vw', '425px': '90vw' }" (onHide)="onCloseStripe()">
		<div style="padding: 2rem !important">
			@if (elementsOptions.clientSecret) {
			<ngx-stripe-payment [elementsOptions]="elementsOptions"></ngx-stripe-payment>
			}
			<button pButton class="mt-5 pt-3 pb-3 btn btn-basic w-100 m-0 btn btn-primary" (click)="paywithstripe()">
				<i class="fa-solid fa-lock mx-2"></i>
				Pay {{ subscriptionCurrency }} {{ subscriptionDetails?.finalPrice }} 
			</button>
		</div>
	</p-dialog>
</ng-container>
<p-dialog [(visible)]="showPremimumPopup" [modal]="true" [draggable]="false" [resizable]="false"
	class="why-premium" [breakpoints]="{ '960px': '60vw', '959px': '75vw', '425px': '90vw' }" [closable]="false">
	 <ng-template pTemplate="header">
		<div class="d-flex justify-content-between gap-2 w-100">
			<h3>üöÄ This Job Can Only Be Applied by Verified Candidates!</h3>
			<button class="btn btn-primary btn-rounded" (click)="onClosePremiumPopup()"><i class="fa fa-times"></i></button>
		</div>
  	</ng-template>
	<div class="row">
		<div class="col-12">
			<h6 class="mb-3 fw-semibold">Verify Now & Get Instant Access To:</h6>
			<div class="d-flex flex-column gap-3">
				@for (feature of premiumFeatures; track $index) {
					<div class="d-flex align-items-center">
						<span [innerHTML]="feature"></span>
					</div>
				}
			</div>
			<h5 class="mt-3 mb-0 fw-semibold">Once Verified, you can apply to 30,000+ jobs worldwide without restrictions!</h5>
			<h4 class="uniprep-primary mt-2">‚≠ê 52,382 job seekers are already verified this month.</h4>
		</div>
	</div>
	<div class="center-align mt-3">
		<button pButton class="btn-secondary px-5" [rounded]="true" type="button" (click)="applyNow()">Get Verified & Apply Now</button>
	</div>
</p-dialog>