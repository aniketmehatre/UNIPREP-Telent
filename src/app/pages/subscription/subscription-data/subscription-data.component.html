<p class="uniprep-primary mb-0">Subscription</p>
<div class="card">
	<div class="card-body">
		<div class="d-flex justify-content-between">
			<div>
				<h5 class="sop-border sop-header">Ready To Get Started?</h5>
				<span>Choose a plan tailored to your needs</span>
			</div>
			<div>
				<!-- <button (click)="buttonclicked1()" class="btn btn-basic mt-4" [class.active]="selectedButton === 'button1'" (click)="selectedButton = 'button1'" *ngIf="topupcountries">BASE SUBSCRIPTION</button> -->
				<!-- <button (click)="buttonclicked2()" class="btn btn-basic mt-4" [class.active]="selectedButton === 'button2'" (click)="selectedButton = 'button2'" *ngIf="basesubscription">TOP UP COUNTRIES</button> -->
				<!-- <button (click)="buttonclicked3()" class="btn btn-primary" [class.active]="selectedButton === 'button3'" (click)="selectedButton = 'button3'" >TOP UP VALIDITY</button> -->
				<div class="text-end pt-3" *ngIf="showHistoryBtn">
					<button class="btn btn-primary" (click)="gotoHistory()">Subscription History</button>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="card d-flex mt-2" style="flex: 1">
	<div class="card-body d-flex flex-column justify-content-center">
		<ng-container *ngIf="basesubscription">
			<div class="row">
				<div *ngFor="let subscription of subscriptionList" class="col-lg-4">
					<div class="card-body">
						<div class="container-fluid">
							<div class="row gap-5 d-flex">
								<div class="card card-bg subscriptioncard col px-0"
									[ngClass]="{ active: subscription.isActive }">
									<div class="mostpopular" *ngIf="subscription.popular == 1">Most Popular Plan</div>
									<div class="card-header py-2 px-4">
										<div class="d-flex justify-content-between align-items-center">
											<h3 class="fw-semibold mb-0">{{ subscription.subscription_plan }} <br />Plan
											</h3>
											<div class="text-end">
												<h5 class="mb-0">INR {{ subscription.actualprice | number : ".2-2" }}
												</h5>
												<div class="btn discountbutton btnCurser">Save {{ subscription.discountpercentage
													}} %</div>
											</div>
										</div>
									</div>
									<div class="card-body p-4">
										<h5 style="font-size: 18px; text-align: center">Select Your Base Country</h5>
										<span class="p-float-label">
											<p-dropdown class="subcountry" [options]="subscription.filteredCountryList"
												styleClass="w-100" [(ngModel)]="subscription.selectedCountry"
												optionLabel="country">
												<ng-template pTemplate="selectedItem">
													<img [src]="subscription.selectedCountry?.flag"
														[alt]="subscription.selectedCountry?.altname"
														class="base-country-flag" />
													{{ subscription.selectedCountry?.country }}
												</ng-template>
											</p-dropdown>
										</span>
										<h5 style="font-size: 18px; text-align: center" class="pt-4">Personalized
											Question: {{ subscription.chatlimit }} / day</h5>
									</div>
									<div class="card-footer py-2 px-4" style="text-align: center" [ngClass]="subscription.popular != 1 ? 'mb-5' : '' ">
										<h3 class="font-primarycolor fw-bold">INR {{ subscription.givenprice | number :
											".2-2" }}</h3>
										<h5 class="fw-semibold">{{ subscription.validity }} Month Validity</h5>
										<div class="getstartedbtn pb-2">
											<button *ngIf="!subscription.selected" class="btn btn-primary"
												(click)="selectedSubscriptionPlan(subscription)">Select This
												Plan</button>
											<button *ngIf="subscription.selected" class="btn dark-btn"
												(click)="selectedSubscriptionPlan(subscription)">You have selected {{
												subscription.subscription_plan }} Plan</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<br>
			<div class="offer-msg">
				Congratulations ! Early bird offer. You get free access to 12 other countries with the base
				subscription. Subscribe before the offer ends.
			</div>
		</ng-container>

		<!-- Top-up-countries -->
		<div class="row" *ngIf="topupcountries">
			<div *ngFor="let subscription of subscriptionTopupList" class="col-lg-4">
				<div class="card-body">
					<div class="container-fluid">
						<div class="row gap-5 mt-4 d-flex">
							<div class="card card-bg subscriptioncard col px-0"
								[ngClass]="{ active: subscription.isActive }">
								<div class="mostpopular" *ngIf="subscription.popular == 1">Most Popular Plan</div>
								<div class="card-header p-4">
									<div class="d-flex justify-content-between align-items-center">
										<h3 class="fw-bold mb-0">{{ subscription.name }} <br />Plan</h3>
										<div class="text-end">
											<h4 class="mb-0">
												<s>INR {{ subscription.price | number : ".2-2" }}</s>
											</h4>
											<div class="btn discountbutton">Save {{ subscription.discountPercentage }} %
											</div>
										</div>
									</div>
								</div>
								<div class="card-body p-3">
									<h5 style="font-size: 18px; text-align: center">Select Your Add On Countries</h5>
									<p-multiSelect [options]="subscription.filteredCountryList" styleClass="w-100"
										[(ngModel)]="subscription.selectedCoutriesList"
										defaultLabel="Select a multiple countries as per your requirement"
										optionLabel="country" #multiSelect>
										<ng-template pTemplate="selectedItems">
											{{ multiSelect.defaultLabel }}
										</ng-template>
									</p-multiSelect>
									<div class="d-flex align-items-center gap-2 flex-wrap pt-2">
										<div *ngFor="let data of subscription?.selectedCoutriesList">
											<p-chip [label]="data.country" [image]="data.flag" [removable]="true"
												(onRemove)="removeCountry(subscription.id, data.id)"
												removeIcon="pi pi-times"></p-chip>
										</div>
									</div>
								</div>
								<div class="card-footer p-4" style="text-align: center">
									<h2 class="font-primarycolor fw-bold">INR {{ subscription.finalamount | number :
										".2-2" }}</h2>
									<p class="fw-semibold">{{ subscription.validity }} Month Validity</p>
									<div class="getstartedbtn">
										<button *ngIf="!subscription.selected" class="btn btn-primary"
											(click)="selectedTopupCountryPlan(subscription)">Select Plan</button>
										<button *ngIf="subscription.selected" class="btn dark-btn"
											(click)="selectedTopupCountryPlan(subscription)">You have selected {{
											subscription.name }} Plan</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- top up validity -->
		<div class="row p-3" *ngIf="topupvalidity">
			<div class="d-flex justify-content-between">
				<div class="mt-2">
					<label for="" style="white-space: nowrap">Select Country for Validity</label>
				</div>
				<div class="ms-2" style="width: -webkit-fill-available">
					<span class="p-float-label">
						<p-multiSelect [options]="countryList" optionValue="id" placeholder="Select a country"
							[(ngModel)]="selectedCountry" styleClass="w-100 custom-multiselect"
							optionLabel="country"></p-multiSelect>
					</span>
				</div>
			</div>
		</div>
		<div class="cardcontainer" *ngIf="topupvalidity">
			<div class="card-body sameline">
				<div class="container-fluid">
					<div class="row gap-5 mt-4 d-flex">
						<div class="card col px-0">
							<!-- <div class="mostpopular">Most Popular Plan</div> -->
							<div class="card-header p-4">
								<div class="d-flex justify-content-between align-items-center">
									<h6 class="fw-bold mb-0">1 Month <br />Validity</h6>
									<div class="text-end">
										<span class="mb-0"><s>INR 1000</s></span>
										<div class="btn discountbutton">Save 20 %</div>
									</div>
								</div>
							</div>
							<div class="card-footer p-4 pt-5" style="text-align: center">
								<h4 class="font-primarycolor fw-bold">INR 699.00</h4>
								<div class="">
									<button style="width: -webkit-fill-available" class="btn btn-primary"><span
											style="color: #fff !important" class="ps-5 pe-5">Top Up</span></button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="card-body sameline">
				<div class="container-fluid">
					<div class="row gap-5 mt-4 d-flex">
						<div class="card col px-0">
							<!-- <div class="mostpopular">Most Popular Plan</div> -->
							<div class="card-header p-4">
								<div class="d-flex justify-content-between align-items-center">
									<h6 class="fw-bold mb-0">1 Month <br />Validity</h6>
									<div class="text-end">
										<span class="mb-0"><s>INR 1000</s></span>
										<div class="btn discountbutton">Save 20 %</div>
									</div>
								</div>
							</div>
							<div class="card-footer p-4 pt-5" style="text-align: center">
								<h4 class="font-primarycolor fw-bold">INR 699.00</h4>
								<div class="">
									<button style="width: -webkit-fill-available" class="btn btn-primary"><span
											style="color: #fff !important" class="ps-5 pe-5">Top Up</span></button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="card-body sameline">
				<div class="container-fluid">
					<div class="row gap-5 mt-4 d-flex">
						<div class="card col px-0">
							<!-- <div class="mostpopular">Most Popular Plan</div> -->
							<div class="card-header p-4">
								<div class="d-flex justify-content-between align-items-center">
									<h6 class="fw-bold mb-0">1 Month <br />Validity</h6>
									<div class="text-end">
										<span class="mb-0"><s>INR 1000</s></span>
										<div class="btn discountbutton">Save 20 %</div>
									</div>
								</div>
							</div>

							<div class="card-footer p-4 pt-5" style="text-align: center">
								<h4 class="font-primarycolor fw-bold">INR 699.00</h4>
								<div class="">
									<button style="width: -webkit-fill-available" class="btn btn-primary"><span
											style="color: #fff !important" class="ps-5 pe-5">Top Up</span></button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="card-body sameline">
				<div class="container-fluid">
					<div class="row gap-5 mt-4 d-flex">
						<div class="card col px-0">
							<!-- <div class="mostpopular">Most Popular Plan</div> -->
							<div class="card-header p-4">
								<div class="d-flex justify-content-between align-items-center">
									<h6 class="fw-bold mb-0">1 Month <br />Validity</h6>
									<div class="text-end">
										<span class="mb-0"><s>INR 1000</s></span>
										<div class="btn discountbutton">Save 20 %</div>
									</div>
								</div>
							</div>

							<div class="card-footer p-4 pt-5" style="text-align: center">
								<h4 class="font-primarycolor fw-bold">INR 699.00</h4>
								<div class="">
									<button style="width: -webkit-fill-available" class="btn btn-primary"><span
											style="color: #fff !important" class="ps-5 pe-5">Top Up</span></button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="card-body sameline">
				<div class="container-fluid">
					<div class="row gap-5 mt-4 d-flex">
						<div class="card col px-0">
							<!-- <div class="mostpopular">Most Popular Plan</div> -->
							<div class="card-header p-4">
								<div class="d-flex justify-content-between align-items-center">
									<h6 class="fw-bold mb-0">1 Month <br />Validity</h6>
									<div class="text-end">
										<span class="mb-0"><s>INR 1000</s></span>
										<div class="btn discountbutton">Save 20 %</div>
									</div>
								</div>
							</div>
							<div class="card-footer p-4 pt-5" style="text-align: center">
								<h4 class="font-primarycolor fw-bold">INR 699.00</h4>
								<div class="">
									<button style="width: -webkit-fill-available" class="btn btn-primary"><span
											style="color: #fff !important" class="ps-5 pe-5">Top Up</span></button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="d-flex mt-3 gap-3 flex-column flex-md-row">
	<div class="card flex-fill h-100">
		<div class="card-body d-flex align-items-center">
			<div class="w-100">
				<div class="row w-100">
					<div class="col-lg-6">
						<h5 class="mb-0">Checkout What You<br />Get With Our Subscriptions</h5>
					</div>
					<div class="col-lg-6">
						<button (click)="moreabout()" class="btn btn-primary w-100 py-3 h6 m-0">Know More About Our
							Features</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="card flex-fill h-100">
		<div class="card-body d-flex align-items-center">
			<div class="w-100">
				<h6>Apply your coupon code here</h6>
				<div class="p-inputgroup inputheight mt-1">
					<input [(ngModel)]="couponInput" (keyup)="onInput($event)" pInputText
						placeholder="Enter Your coupon code Here" type="text" />
					<button (click)="applyCoupon()" class="btn-primary" label="Apply" pButton pRipple
						type="button"></button>
				</div>
				<p class="mb-0 small"><span class="uniprep-lightgray" *ngIf="!invalidCoupon">Please enter a discount
						code to avail further discounts</span><span class="text-danger" *ngIf="invalidCoupon">You
						entered an invalid discount code. Please check the code and try again</span>&nbsp;</p>
			</div>
		</div>
	</div>
	<div class="card flex-fill h-100 justify-content-center">
		<div class="card-body d-flex align-items-center">
			<div class="w-100">
				<div class="d-flex flex-row">
					<div class="flex-grow-1">
						<div *ngIf="basesubscription">
							<p class="fw-semibold mb-0">Total</p>
							<h4 class="mb-0 uniprep-primary" *ngIf="checkoutTotal == ''">INR {{ subscriptionTotal |
								number : ".2-2" }}</h4>
							<h4 class="mb-0 uniprep-primary" *ngIf="subscriptionTotal != '0.00' && checkoutTotal != ''">
								INR {{ checkoutTotal | number : ".2-2" }}</h4>
							<p *ngIf="discountAmountEnable">Discount Percentage:{{discountPercentage}}%</p>
						</div>
						<div *ngIf="topupcountries">
							<h5 class="fw-semibold mb-0">Countries: <span class="uniprep-primary">{{
									selectedTopupCountryDetails?.selectedCoutriesList?.length }}</span></h5>
							<h5 class="fw-semibold mb-0">Total:
								<span class="uniprep-primary" *ngIf="checkoutTotal == ''"> INR {{ subscriptionTotal |
									number : ".2-2" }}</span>
								<span class="uniprep-primary"
									*ngIf="subscriptionTotal != '0.00' && checkoutTotal != ''"> INR {{ checkoutTotal |
									number : ".2-2" }}</span>
							</h5>
						</div>
					</div>
					<div class="flex-full">
						<button [disabled]="showCheckout" class="btn btn-primary w-100 py-3 px-5 h6 m-0"
							(click)="basesubscription ? confirmModal=true : checkout()">Checkout</button>
						<p *ngIf="discountAmountEnable">Discount Amount: {{discountAmount}}</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- last know more about section -->

	<!-- modeal -->

	<p-dialog class="retrypopup" [modal]="true" [closable]="false" header="Header" footer="Footer"
		[(visible)]="isInstructionVisible" [style]="{ width: '27vw' }" [breakpoints]="{ '960px': '75vw' }"
		[draggable]="false" [resizable]="false">
		<ng-template pTemplate="header" style="overflow: hidden"></ng-template>
		<span style="float: right"><i (click)="closeAllHome()"
				class="fa-solid fa-circle-xmark fa-2x custom-icon"></i></span>
		<div style="margin: 10px 10px 10px 10px">
			<div class="card text-center mt-1" style="background-color: #fbfbfb; padding: 10px">
				<h3 class="p-2">What You Get With The Subscription</h3>
			</div>
		</div>

		<div class="container-fluid bg-white">
			<div class="row">
				<div class="col-md-12">
					<div class="font-secondarycolor fw-medium lh-lg">
						<p>
							<span><i class="fa-solid fa-circle-check custom-icon1"></i>&nbsp;</span>Discover Unexplored
							Questions.
						</p>
						<p>
							<span><i class="fa-solid fa-circle-check custom-icon1"></i>&nbsp;</span>Get access to smart
							tools and resources to build your profile
						</p>
						<p>
							<span><i class="fa-solid fa-circle-check custom-icon1"></i>&nbsp;</span>Alerts on upcoming
							events
						</p>
						<p>
							<span><i class="fa-solid fa-circle-check custom-icon1"></i>&nbsp;</span>Navigate Using
							Keyword Search
						</p>
						<p>
							<span><i class="fa-solid fa-circle-check custom-icon1"></i>&nbsp;</span>Get Expert Answers
							To Your Queries
						</p>
						<p>
							<span><i class="fa-solid fa-circle-check custom-icon1"></i>&nbsp;</span>Find Answers To Your
							Question With Verified Source Links
						</p>
						<p>
							<span><i class="fa-solid fa-circle-check custom-icon1"></i>&nbsp;</span>Find Over 5 Lakh
							Questions And Answers Throughout Platform
						</p>
						<p>
							<span><i class="fa-solid fa-circle-check custom-icon1"></i>&nbsp;</span>Ask Any Personalized
							Questions & Get Answer Within 8 Working Hours
						</p>
					</div>
				</div>
			</div>
		</div>
	</p-dialog>
	<p-dialog [(visible)]="confirmModal" [modal]="true" [style]="{width: '30vw'}">
		<div class="container-fluid bg-white pb-3">
			<div class="confirm-modal-header">
				Confirm Subscription
			</div>
			<div class="container-fluid px-3 py-3">
				<div class="d-flex align-items-center gap-2">
					<div class="fw-bold">Selected Base Country</div>
					<div class="confirm-modal-country">
						<img [src]="selectedSubscriptionDetails?.selectedCountry?.flag" alt="country" style="width: 25px;height: 25px;">
						<div class="fw-bold">{{selectedSubscriptionDetails?.selectedCountry?.country}}</div>
					</div>
				</div>
				<div class="fw-bold">Congratulations !</div>
				<div>Early Bird Offer.</div>
				<div>You Get Free Access To 12 Other Countries With The Base Subscription.</div>
				<div>Subscribe Before The Offer Ends.</div>
			</div>
			<div *ngIf="couponInput" class="confirm-modal-header" style="padding: 10px 15px; font-size: 16px;">
				Applied Coupon : {{couponInput}}
			</div>
			<br>
			<div class="confirm-modal-header d-flex align-items-center justify-content-between" style="padding: 10px 15px;">
				<div>
					<p class="fw-semibold mb-0">Total</p>
					<h4 class="mb-0 uniprep-primary" *ngIf="checkoutTotal == ''">INR {{ subscriptionTotal |
						number : ".2-2" }}</h4>
					<h4 class="mb-0 uniprep-primary" *ngIf="subscriptionTotal != '0.00' && checkoutTotal != ''">
						INR {{ checkoutTotal | number : ".2-2" }}</h4>
				</div>
				<button class="btn btn-primary py-3 px-5 h6 m-0"
					(click)="checkout()">Confirm</button>
			</div>


		</div>
	</p-dialog>
</div>