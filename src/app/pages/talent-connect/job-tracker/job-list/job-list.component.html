<div class="card h-100 bg-white">
	<div class="card-header d-flex justify-content-between align-items-center bg-transparent">
		<h4 class="m-0">All</h4>
		<span class="text-muted">Total Jobs : {{ totalAppliedJobs }}</span>
	</div>
	<div class="card-body overflow-y-auto p-0 h-100">
		<p-tabView [(activeIndex)]="activeIndex" [scrollable]="true" styleClass="p-0"
			(activeIndexChange)="selectTab($event)">
			<p-tabPanel *ngFor="let tab of tabs" [header]="tab.label" class="p-0 h-100">
				<div class="card mb-2" role="button" (click)="onClickJobCard(job.id)"
					*ngFor="let job of filteredAppliedJob">
					<div class="card-body d-flex align-items-start gap-2 position-relative">
						<div class="w-100 border rounded-2 overflow-hidden" style="max-width: 65px">
							<img src="{{ job.company_logo }}"
								(error)="$event.target.src = '/uniprep-assets/images/job.webp'" class="w-100 h-100"
								style="object-fit: contain" alt="Logo" />
						</div>
						<div class="text-start">
							<h5 class="mb-0">{{ job.position }}</h5>
							<p class="text-muted text-small fw-medium">{{ job.company_name }}</p>
							<p class="d-flex gap-2 align-items-center text-small">
								<span><i class="fa-solid fa-location-dot" style="color: #9bc329"></i></span><span>{{
									job.worklocation }}</span>
							</p>
							<span class="status-badge" [style.color]="'white'"
								[style.backgroundColor]="job.color_code">{{ job.stage }}</span>
						</div>
						<span class="notification-badge"
							[ngClass]="{ 'bg-secondary-subtle text-white': !(job.unreadmessageCount > 0) }">
							{{ job.unreadmessageCount }}
						</span>
					</div>
				</div>
			</p-tabPanel>
		</p-tabView>
	</div>
	<div class="card-footer bg-transparent">
		<div class="pagination-container d-flex justify-content-between align-items-center">
			<button class="btn btn-light" (click)="onBackClick()"><i class="pi pi-chevron-left me-1 fs-6"></i>
				Back</button>
			<span>Page {{ page }} / {{ totalPage }}</span>
			<button class="btn btn-light" (click)="onNextClick()">Next <i
					class="pi pi-chevron-right ms-1 fs-6"></i></button>
		</div>
	</div>
</div>

<div>
	<p-dialog header="Filter" [(visible)]="displayModal" [modal]="true" [style]="{ width: '80%' }" [baseZIndex]="10000"
		[draggable]="false" [resizable]="false" (onHide)="displayModal = false; closeFilter.emit(false)"
		styleClass="container">
		<form [formGroup]="filterForm" class="p-3">
			<div class="row g-3">
				<div class="col-md-12">
					<label class="form-label fw-bold">Search</label>
					<div class="p-inputgroup">
						<input type="text" pInputText formControlName="keyword" placeholder="Search by Company name"
							class="form-control" />
					</div>
				</div>

				<div class="col-md-4">
					<label class="form-label fw-bold">Position Title</label>
					<div class="p-inputgroup">
						<input type="text" pInputText formControlName="position" placeholder="Enter position title"
							class="form-control w-100" />
					</div>
				</div>

				<div class="col-md-4">
					<label class="form-label fw-bold">Work Location </label>
					<p-multiSelect [options]="locations" formControlName="worklocation"
						placeholder="Select work location" optionLabel="work_location" optionValue="id" display="chip"
						[virtualScroll]="true" [virtualScrollItemSize]="50" [filter]="true" filterBy="work_location"
						class="w-100"> </p-multiSelect>
				</div>

				<div class="col-md-4">
					<label class="form-label fw-bold">Work Mode </label>
					<p-multiSelect [options]="workModes" formControlName="work_mode" placeholder="Select work mode"
						optionLabel="work_mode" optionValue="id" display="chip" class="w-100"> </p-multiSelect>
				</div>

				<div class="col-md-4">
					<label class="form-label fw-bold">Work Type </label>
					<p-multiSelect [options]="employmentTypes" formControlName="employment_type"
						placeholder="Select work type" optionLabel="employment_type" optionValue="id" display="chip"
						class="w-100"> </p-multiSelect>
				</div>

				<div class="col-md-4">
					<label class="form-label fw-bold">Currency display for salaries</label>
					<p-select [options]="currencies" formControlName="currency" optionLabel="currency_code"
						optionId="id" [filter]="true" appendTo="body" filterBy="currency_code" class="w-100"
						placeholder="Select your currency"> </p-select>
				</div>

				<div class="col-md-4">
					<label class="form-label fw-bold">Salary range offered per month</label>
					<div class="d-flex w-100 gap-2">
						<p-select [options]="currencies" styleClass="p-select p-component" optionLabel="currency_code"
							optionValue="id" placeholder="Select currency" formControlName="currency"
							[style]="{ width: '150px' }"> </p-select>
						<div class="d-flex gap-2 align-items-center flex-grow-1">
							<p-inputNumber placeholder="Min" styleClass="w-100" [showButtons]="false" class="w-100"
								formControlName="min_salary"></p-inputNumber>
							<div>To</div>
							<p-inputNumber placeholder="Max" styleClass="w-100" [showButtons]="false" class="w-100"
								formControlName="max_salary"></p-inputNumber>
						</div>
					</div>
				</div>

				<div class="col-md-4">
					<label class="form-label fw-bold">Experience Level </label>
					<p-multiSelect [options]="experienceLevels" formControlName="experienceLevel"
						placeholder="Enter your experience level" optionLabel="experienceLevel"
						optionValue="experienceLevel" display="chip" class="w-100" appendTo="body"> </p-multiSelect>
				</div>
				<div class="col-md-4">
					<label class="form-label fw-bold">Status</label>
					<p-select [options]="jobStatusList" appendTo="body" [filter]="true" formControlName="status"
						display="chip" placeholder="Select your status" optionLabel="hiringstage" optionValue="id"
						class="w-100">
					</p-select>
				</div>
				<div class="col-md-4">
					<label class="form-label fw-bold">Hiring Status </label>
					<p-multiSelect [options]="hiringStatuses" formControlName="hiringStatus"
						placeholder="Select hiring type" optionLabel="name" optionValue="id" display="chip"
						class="w-100" appendTo="body"> </p-multiSelect>
				</div>
				<div class="col-md-6">
					<label class="form-label fw-bold">Hiring Type </label>
					<p-multiSelect [options]="hiringTypes" formControlName="hiring_type" optionLabel="name"
						placeholder="Select the Introduction video" optionValue="id" appendTo="body" display="chip"
						class="w-100"> </p-multiSelect>
				</div>
				<div class="col-md-6 h-full mt-auto">
					<button pButton label="Apply Filter" (click)="applyFilter()" class="btn-primary w-100"></button>
				</div>
			</div>
		</form>

		<div class="dialog-footer p-3 d-flex justify-content-center w-100">
			<div class="col-md-4 h-full mt-auto w-100">
				<button pButton label="Reset Filter" (click)="resetFilter()"
					class="p-button-text text-primary"></button>
			</div>
		</div>
	</p-dialog>
</div>