<div class="h-100 overflow-hidden">
  <!-- Header Section -->
  <div class="w-100 bg-primary rounded-top-4 text-start d-flex justify-content-between align-items-center py-3 px-4 overflow-hidden">
    <h5 class="text-white fw-medium fs-4">{{isSample ? 'Sample Profile' : profileData.personalInfo.fullName + '\'s profile'}}</h5>
    <i class="fa-solid fa-circle-xmark fs-2 cursor-pointer" style="color: white;" (click)="closeDialog()"></i>
  </div>
  
  <!-- Main Content Area with Scrolling -->
  <div class="profile-dialog-content h-100 overflow-y-auto text-wrap" style="padding-bottom: 100px;">
    <div class="container-fluid profile-container">
      
      <!-- Personal Information Section -->
      <section class="card-inside mb-4">
        <div class="card-body">
          <div class="row">
            <div class="col-md-3 text-center">
              <div class="d-flex justify-content-center align-items-center border border-black h-100 p-4 rounded-3">
                <div class="bg-secondary-subtle h-100 w-100 d-flex justify-content-center align-items-center rounded-3"
                  style="border: 1px dashed">
                  <img (error)="$event.target.src = '/uniprep-assets/images/avatar.webp'"
                    [src]="profileData.personalInfo.logo ?? 'uniprep-assets/images/avatar.png'" class="rounded-circle"
                    alt="Profile Photo" width="150" height="150">
                </div>
              </div>
            </div>
            <div class="col-md-9">
              <div class="card-header">
                <h4>Personal Information</h4>
              </div>
              <div class="row">
                <div class="col-md-6" *ngIf="profileData.personalInfo?.fullName">
                  <h5>Full Name</h5>
                  <p>{{ profileData.personalInfo.fullName }}</p>
                </div>
                <div class="col-md-6" *ngIf="profileData.personalInfo?.dateOfBirth">
                  <h5>Date of Birth</h5>
                  <p>{{ isSample ? profileData.personalInfo.dateOfBirth : (profileData.personalInfo.dateOfBirth | date: 'dd-MM-yyyy')}}</p>
                </div>
                <div class="col-md-6" *ngIf="profileData.personalInfo?.gender">
                  <h5>Gender</h5>
                  <p>{{ profileData.personalInfo.gender }}</p>
                </div>
                <div class="col-md-6" *ngIf="profileData.educationDetails?.length && profileData.educationDetails[profileData.educationDetails.length - 1]?.graduationYear">
                  <h5>Graduation Year</h5>
                  <p>{{ profileData.educationDetails[profileData.educationDetails.length - 1].graduationYear }}</p>
                </div>
                <div class="col-md-6" *ngIf="profileData.personalInfo?.nationality">
                  <h5>Nationality</h5>
                  <p>{{ profileData.personalInfo.nationality }}</p>
                </div>
                <div class="col-md-12" *ngIf="profileData.personalInfo?.location">
                  <h5>Current Location</h5>
                  <p>{{ profileData.personalInfo.location }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Education Details Section -->
      <section class="card-inside mb-4" *ngIf="profileData.educationDetails?.length">
        <div class="card-header">
          <h4>Education Details</h4>
        </div>
        <div class="card-body">
          <div class="row mb-3" *ngFor="let education of profileData.educationDetails; let last = last">
            <div class="col-md-6" *ngIf="education.highestQualification">
              <h5>Highest Qualification</h5>
              <p>{{ education.highestQualification }}</p>
            </div>
            <div class="col-md-6" *ngIf="education.university">
              <h5>University</h5>
              <p>{{ education.university }}</p>
            </div>
            <div class="col-md-6" *ngIf="education.fieldOfStudy">
              <h5>Field of Study</h5>
              <p>{{ education.fieldOfStudy }}</p>
            </div>
            <div class="col-md-6" *ngIf="education.courseName">
              <h5>Course Name</h5>
              <p>{{ education.courseName }}</p>
            </div>
            <div class="col-md-6" *ngIf="education.graduationYear">
              <h5>Graduation Year</h5>
              <p>{{ education.graduationYear }}</p>
            </div>
            <div class="col-md-6" *ngIf="education.gpa">
              <h5>GPA</h5>
              <p>{{ education.gpa }}</p>
            </div>
            <hr *ngIf="!last" class="mt-3">
          </div>
        </div>
      </section>

      <!-- Work Experience Section -->
      <section class="card-inside mb-4" *ngIf="profileData.workExperience?.length || profileData.personalInfo?.total_years_of_experience">
        <div class="card-header">
          <h4>Work Experience & Internships</h4>
        </div>
        <div class="card-body">
          <div class="row" *ngIf="profileData.personalInfo?.total_years_of_experience">
            <div class="col-12 mb-3">
              <h5>Total Years of Experience</h5>
              <p>{{ profileData.personalInfo.total_years_of_experience }} Years</p>
            </div>
          </div>
          <div class="experience-item mb-4" *ngFor="let experience of profileData.workExperience; let last = last">
            <div class="row">
              <div class="col-md-6" *ngIf="experience.totalExperience">
                <h5>Years of Experience</h5>
                <p>{{ experience.totalExperience }} Years</p>
              </div>
              <div class="col-md-6" *ngIf="experience.companyName">
                <h5>Company Name</h5>
                <p>{{ experience.companyName }}</p>
              </div>
              <div class="col-md-6" *ngIf="experience.jobTitle">
                <h5>Job Title</h5>
                <p>{{ experience.jobTitle }}</p>
              </div>
              <div class="col-md-6" *ngIf="experience.duration">
                <h5>Duration</h5>
                <p>{{ experience.duration }}</p>
              </div>
              <div class="col-md-6" *ngIf="experience.employmentType">
                <h5>Employment Type</h5>
                <p>{{ experience.employmentType }}</p>
              </div>
              <div class="col-md-6" *ngIf="experience.salary">
                <h5>Salary</h5>
                <p>{{ experience.salary }}</p>
              </div>
              <div class="col-md-12 text-wrap" *ngIf="experience.responsibilities">
                <h5>Job Responsibilities</h5>
                <div [innerHTML]="experience.responsibilities"></div>
              </div>
              <div class="col-md-6" *ngIf="experience.experienceLetter?.name">
                <h5>Experience letter</h5>
                <div class="d-flex justify-content-between align-items-center border p-2 rounded bg-secondary-subtle">
                  <span>{{extractLastName(experience.experienceLetter.name)}}</span>
                  <button class="btn btn-outline-primary btn-sm" (click)="experience.experienceLetter.file.includes('http') ? downloadFile(experience.experienceLetter.file) : downloadFile(experience.experienceLetter.file.path)">
                    <i class="pi pi-download"></i>
                  </button>
                </div>
              </div>
            </div>
            <hr *ngIf="!last" class="mt-3">
          </div>
        </div>
      </section>

      <!-- Career Preferences Section -->
      <section class="card-inside mb-4" *ngIf="profileData.careerPreferences">
        <div class="card-header">
          <h4>Career Preferences & Aspirations</h4>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6" *ngIf="profileData.careerPreferences.careerStatus">
              <h5>Career Status</h5>
              <p>{{ profileData.careerPreferences.careerStatus }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.careerPreferences.jobTitle">
              <h5>Job Title</h5>
              <p>{{ profileData.careerPreferences.jobTitle }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.careerPreferences.careerInterest">
              <h5>Career Interest/Industry</h5>
              <p>{{ profileData.careerPreferences.careerInterest }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.careerPreferences.preferredWorkLocation">
              <h5>Preferred Work Location</h5>
              <p>{{ profileData.careerPreferences.preferredWorkLocation }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.careerPreferences.preferredEmploymentType">
              <h5>Preferred Employment Type</h5>
              <p>{{ profileData.careerPreferences.preferredEmploymentType }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.careerPreferences.preferredWorkplaceType">
              <h5>Preferred Workplace Type</h5>
              <p>{{ profileData.careerPreferences.preferredWorkplaceType }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.careerPreferences.willingToRelocate">
              <h5>Willingness to Relocate</h5>
              <p>{{ profileData.careerPreferences.willingToRelocate }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.careerPreferences.salaryRange">
              <h5>Salary Range</h5>
              <p>{{ profileData.careerPreferences.salaryRange }}</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Certifications Section -->
      <section class="card-inside mb-4" *ngIf="profileData.certifications?.length">
        <div class="card-header">
          <h4>Certifications & Achievements</h4>
        </div>
        <div class="card-body">
          <div class="row g-2">
            <div class="col-md-6" *ngFor="let cert of profileData.certifications">
              <div class="d-flex justify-content-between align-items-center border p-2 rounded bg-secondary-subtle">
                <span>{{cert.name}}</span>
                <button class="btn btn-outline-primary btn-sm">
                  <a [href]="cert.file" [download]="cert.file" target="_blank">
                    <i class="pi pi-download"></i>
                  </a>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Additional Details Section -->
      <section class="card-inside mb-4" *ngIf="profileData.additionalDetails?.languagesKnown?.length || profileData.additionalDetails?.hobbiesAndInterests">
        <div class="card-header">
          <h4>Additional Details</h4>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6" *ngIf="profileData.additionalDetails?.languagesKnown?.length">
              <h5>Languages Known</h5>
              <p>{{ profileData.additionalDetails.languagesKnown.join(', ') }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.additionalDetails?.hobbiesAndInterests">
              <h5>Hobbies & Interests</h5>
              <p>{{ profileData.additionalDetails.hobbiesAndInterests }}</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Key Strengths Section -->
      <section class="card-inside mb-4" *ngIf="profileData.keyStrengths">
        <div class="card-header">
          <h4>Key Strengths & Professional Traits</h4>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-12 text-wrap" *ngIf="profileData.keyStrengths.industryDifferentiators">
              <h5>What Sets You Apart in Your Industry?</h5>
              <p [innerHTML]="profileData.keyStrengths.industryDifferentiators"></p>
            </div>
            <div class="col-md-6" *ngIf="profileData.keyStrengths.topProfessionalStrength">
              <h5>Top Professional Strength</h5>
              <p>{{ profileData.keyStrengths.topProfessionalStrength }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.keyStrengths.solvedRealWorldChallenge">
              <h5>Solved a Real-World Challenge?</h5>
              <p>{{ profileData.keyStrengths.solvedRealWorldChallenge }}</p>
            </div>
            <div class="col-md-6" *ngIf="profileData.keyStrengths.leadershipRoles">
              <h5>Taken Leadership Roles?</h5>
              <p>{{ profileData.keyStrengths.leadershipRoles }}</p>
            </div>
            <div class="col-md-12" *ngIf="profileData.keyStrengths.mostAdmiredQuality">
              <h5>One Quality Others Admire Most About You</h5>
              <p>{{ profileData.keyStrengths.mostAdmiredQuality }}</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Professional Networking Section -->
      <section class="card-inside mb-4" *ngIf="profileData.networking?.linkedinProfile || (profileData.networking?.socialMedia && profileData.networking.socialMedia.length) || profileData.networking?.personalWebsite">
        <div class="card-header">
          <h4>Professional Networking & Online Presence</h4>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6" *ngIf="profileData.networking?.linkedinProfile">
              <h5>LinkedIn Profile</h5>
              <a [href]="profileData.networking.linkedinProfile" target="_blank">
                {{ profileData.networking.linkedinProfile }}
              </a>
            </div>
            <div class="col-md-6" *ngIf="profileData.networking?.socialMedia && profileData.networking.socialMedia.length">
              <h5>Social Media</h5>
              <ng-container *ngFor="let media of profileData.networking.socialMedia">
                <a [href]="media.link" target="_blank">
                  {{ media.media }}
                </a> <br>
              </ng-container>
            </div>
            <div class="col-md-6" *ngIf="profileData.networking?.personalWebsite">
              <h5>Personal Website</h5>
              <a [href]="profileData.networking.personalWebsite" target="_blank">
                {{ profileData.networking.personalWebsite }}
              </a>
            </div>
          </div>
        </div>
      </section>

      <!-- Attachments Section -->
      <section class="card-inside mb-4" *ngIf="profileData.attachments?.length">
        <div class="card-header">
          <h4>Attachments & Media</h4>
        </div>
        <div class="card-body">
          <div class="row g-3">
            <div *ngFor="let attachment of profileData.attachments" class="col-12">
              <div
                class="d-flex justify-content-between align-items-center border p-2 rounded bg-secondary-subtle cursor-pointer"
                (click)="(attachment.type == 'document') ? $event.stopPropagation() : attachmentLink.click();">
                <span>{{extractLastName(attachment.name)}}</span>
                <button class="btn btn-outline-primary btn-sm" (click)="downloadFile(attachment.name)" target="_blank"
                  *ngIf="attachment.type == 'document'; else link">
                  <i class="pi pi-download"></i>
                </button>
                <ng-template #link>
                  <a [href]="attachment.name" target="_blank" #attachmentLink></a>
                </ng-template>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- References Section -->
      <section class="card-inside" *ngIf="profileData.academicReference?.length || profileData.professionalReference?.length">
        <div class="card-header">
          <h4>References & Endorsements</h4>
        </div>
        <div class="card-body">
          <!-- Academic References -->
          <div *ngIf="profileData.academicReference?.length">
            <h4 class="fw-bold mb-3">Academic Reference</h4>
            <div class="row g-3 mb-4" *ngFor="let reference of profileData.academicReference; let last = last">
              <div class="col-md-4" *ngIf="reference.collegeName">
                <h5>College Name</h5>
                <p>{{reference.collegeName}}</p>
              </div>
              <div class="col-md-4" *ngIf="reference.name">
                <h5>Name</h5>
                <p>{{reference.name}}</p>
              </div>
              <div class="col-md-4" *ngIf="reference.email">
                <h5>Email</h5>
                <p>{{reference.email}}</p>
              </div>
              <div class="col-md-4" *ngIf="reference.designation">
                <h5>Designation</h5>
                <p>{{reference.designation}}</p>
              </div>
              <hr *ngIf="!last" class="col-12 mt-2">
            </div>
          </div>

          <!-- Professional References -->
          <div *ngIf="profileData.professionalReference?.length">
            <h4 class="fw-bold my-3">Professional Reference</h4>
            <div class="row g-3" *ngFor="let reference of profileData.professionalReference; let last = last">
              <div class="col-md-4" *ngIf="reference.companyName">
                <h5>Company Name</h5>
                <p>{{reference.companyName}}</p>
              </div>
              <div class="col-md-4" *ngIf="reference.name">
                <h5>Name</h5>
                <p>{{reference.name}}</p>
              </div>
              <div class="col-md-4" *ngIf="reference.email">
                <h5>Email</h5>
                <p>{{reference.email}}</p>
              </div>
              <div class="col-md-4" *ngIf="reference.designation">
                <h5>Designation</h5>
                <p>{{reference.designation}}</p>
              </div>
              <hr *ngIf="!last" class="col-12 mt-2">
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</div>