<div class="container-fluid student-details">
  <div class="card-header border-0 bg-transparent">
    <div class="row">
      <div class="col-md-12 d-flex gap-2 text-center">
        <div class="backIcon d-md-flex d-none" role="button" routerLink="/pages/talent-connect/list">
          <span class="fa-solid fa-chevron-left"></span>
        </div>
        <div class="select-title d-flex justify-content-between align-items-center">
          <div>
            <h5 class="mb-0" tooltipPosition="top" pTooltip="Questions related to the application process are answered">
              Employee Profile<i class="questiontooltip fa-solid fa-circle-question"></i></h5>
          </div>
          <div>
            <button class="how-it-works-button">How it works?<i class="fa-solid fa-play d-md-block d-none"></i></button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="card mb-4 mt-4">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3 col-lg-2">
          <img [src]="profileData?.dp_image || 'uniprep-assets/images/avatar.webp'" alt="Profile Photo"
            class="img-fluid rounded" />
        </div>
        <div class="col-md-6 col-lg-7">
          <h2 class="fw-bold">{{profileData?.full_name}}</h2>
          <p class="text-muted">Profile Updated On: {{profileData?.updated_at | date: 'dd-MM-yyyy'}}</p>
          <div class="mt-2">
            <button class="py-2 px-4 btn-success" *ngIf="profileData?.careerPreference?.video_link"><a
                [href]="introductionVideo" target="_blank" role="button"
                class="text-decoration-none text-white">Introduction Video Uploaded&nbsp; <i
                  class="fa fa-video"></i></a></button>
            <button class="py-2 px-4 btn btn-danger" *ngIf="!profileData?.careerPreference?.video_link">Introduction
              Video Not Uploaded&nbsp; <i class="fa fa-video"></i></button>
          </div>
          <div class="row g-2 mt-2">
            <div class="col-md-3">
              <div class="d-flex align-items-center">
                <i class="fa fa-calendar text-primary me-2"></i>
                <div>
                  <div class="text-muted small">Date of Birth</div>
                  <div>{{profileData?.date_of_birth | date: 'dd-MM-yyyy'}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="d-flex align-items-center">
                <i class="fa fa-venus-mars text-danger me-2"></i>
                <div>
                  <div class="text-muted small">Gender</div>
                  <div>{{profileData?.gender}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="d-flex align-items-center">
                <i class="fas fa-earth-asia text-primary me-2"></i>
                <div>
                  <div class="text-muted small">Nationality</div>
                  <div>{{profileData?.nationality_name}}</div>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="d-flex align-items-center">
                <i class="fa fa-location-crosshairs text-warning me-2"></i>
                <div>
                  <div class="text-muted small">Current Location</div>
                  <div>{{profileData?.current_location}}</div>
                </div>
              </div>
            </div>
          </div>

          <div class="mt-3">
            <div class="text-muted small mb-1">Profile Completion: {{profileData?.profile_completion}}%</div>
            <p-progressBar [value]="profileData.profile_completion" [showValue]="false" styleClass="custom-progress"
              [style]="{'height': '10px', 'color': 'red' }"></p-progressBar>
          </div>
        </div>
        <div class="col-md-3 col-lg-3 d-flex flex-column gap-2 align-items-end">
          <button class="p-button p-button-outlined" routerLink="/pages/talent-connect/my-profile"><i
              class="pi pi-pencil me-2"></i>Edit Profile</button>
          <!-- <button pButton label="Share Profile" icon="pi pi-share-alt" class="p-button-outlined p-button-warning"></button> -->
        </div>
      </div>
    </div>
  </div>

  <!-- Education Details Section -->
  <div class="card mb-4" *ngIf="profileData.education && profileData.education.length > 0">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Education Details</h3>
        </div>
        <div class="col-md-9">
          <div class="row" *ngFor="let edu of profileData.education">
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Highest Qualification</div>
              <div>{{edu?.qualification_name}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">University / Institution Name</div>
              <div>{{edu?.university_name}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Field of Study / Major</div>
              <div>{{edu?.field_of_study || 'Not specified'}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Course Name</div>
              <div>{{edu?.course_name}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Graduation Year</div>
              <div>{{edu?.graduation_year_name}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">GPA / Percentage</div>
              <div>{{edu?.gpa_percentage}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Work Experience Section -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Work Experience & Internships</h3>
        </div>
        <div class="col-md-9">
          <div class="mb-4">
            <div class="text-primary fw-bold">Total Years of Experience</div>
            <div>{{profileData?.total_years_of_experience || profileData?.overall_years_experience}}</div>
          </div>

          <div class="fw-bold fs-5 mb-3" *ngIf="profileData.work_experience && profileData.work_experience.length > 0">
            Work Experience Details</div>

          <div class="row" *ngIf="profileData.work_experience && profileData.work_experience.length > 0">
            <ng-container *ngFor="let exp of profileData.work_experience">
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Years of Experience</div>
                <div>{{exp?.years_of_experience || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Company Name</div>
                <div>{{exp?.company_name || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Job Title</div>
                <div>{{exp?.job_title || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Employment Type</div>
                <div>{{exp?.employment_type || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Duration</div>
                <div>{{exp?.duration_from + ' - ' + exp?.duration_to || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Salary</div>
                <div>{{exp?.salary_per_month || 'Not specified'}}</div>
              </div>
              <div class="col-12 mb-3">
                <div class="text-primary fw-bold">Job Responsibilities</div>
                <div [innerHTML]="exp?.job_responsibilities || 'Not specified'"></div>
              </div>
              <div class="col-12 mb-3">
                <div class="text-primary fw-bold">Experience Letter</div>
                <button *ngIf="exp?.experience_letter" pButton [label]="extractFileName(exp?.experience_letter)"
                  icon="pi pi-download" class="p-button-outlined p-button-secondary mb-2 justify-content-between"
                  (click)="openView(exp?.experience_letter);" iconPos="right"></button>
              </div>
            </ng-container>
          </div>

          <div *ngIf="!profileData.work_experience || profileData.work_experience.length === 0" class="text-muted">
            No work experience details available
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Career Preferences Section -->
  <div class="card mb-4" *ngIf="profileData.careerPreference">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Career Preferences & Aspirations</h3>
          <div class="mt-3 text-warning">Confused about your career?</div>
          <button pButton label="Click here to plan now!" (click)="routingToPage('/pages/job-tool/career-tool')"
            class="p-button-outlined p-button-warning mt-2"></button>
        </div>
        <div class="col-md-9">
          <div class="row">
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Career Status</div>
              <div>{{profileData.careerPreference?.career_status}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Desired Job Title</div>
              <div>{{profileData.careerPreference.job_title || 'Not specified'}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Interested Industry</div>
              <div>{{profileData.careerPreference.department_name?.join(',') || 'Not specified'}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Preferred Work Location</div>
              <div>{{profileData?.careerPreference?.preferred_work_location?.join(',') || 'Not specified'}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Preferred Work Type</div>
              <div>{{profileData.careerPreference.preferred_workplace_type?.join(',')}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Preferred Work Mode</div>
              <div>{{profileData.careerPreference.preferred_employment_type?.join(',')}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Willingness to Relocate?</div>
              <div>{{profileData.careerPreference?.willingness_to_relocate}}</div>
            </div>
            <div class="col-md-4 col-xl-3 mb-3">
              <div class="text-primary fw-bold">Expected</div>
              <div>{{profileData.careerPreference.expected_salary}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Certifications Section -->
  <div class="card mb-4" *ngIf="profileData.certifications && profileData.certifications.length > 0">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Certifications & Achievements</h3>
          <div class="mt-3 text-warning">Want to add more skills?</div>
          <button pButton label="Click here to add more to your list!"
            (click)="routingToPage('/pages/modules/learning-hub')"
            class="p-button-outlined p-button-warning mt-2"></button>
        </div>
        <div class="col-md-9">
          <div class="row">
            <div class="col-md-8">
              <ng-container *ngFor="let cert of profileData.certifications">
                <div class="mb-3" *ngIf="cert.type === 'Certificate'">
                  <div class="text-primary fw-bold">Professional / online Certifications</div>
                  <div>{{cert.name || 'Not specified'}}</div>
                </div>
                <div class="mb-3" *ngIf="cert.type === 'Achievement'">
                  <div class="text-primary fw-bold">Achievement Name</div>
                  <div>{{cert.name || 'Not specified'}}</div>
                </div>
              </ng-container>
            </div>
            <div class="col-md-4">
              <ng-container *ngFor="let cert of profileData.certifications">
                <button *ngIf="cert.file_name" pButton [label]="extractFileName(cert.file_name)" icon="pi pi-download"
                  class="p-button-outlined p-button-secondary mb-2 w-100 justify-content-between"
                  (click)="openView(cert.file_name);" iconPos="right"></button>
              </ng-container>
              <div class="text-muted" *ngIf="hasNoCertificationFiles()">
                No certification files available
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Additional Details Section -->
  <div class="card mb-4" *ngIf="profileData.languages && profileData.languages.length > 0">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Additional Details</h3>
          <div class="mt-3 text-warning">Looking to add more languages?</div>
          <button pButton label="Click here to start learning!" (click)="routingToPage('/pages/language-hub/languages')"
            class="p-button-outlined p-button-warning mt-2"></button>
        </div>
        <div class="col-md-9">
          <div class="row">
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold mb-2">Languages Known</div>
              <ng-container *ngFor="let lang of profileData.languages">
                <div class="mb-2">
                  <div class="d-flex align-items-center">
                    <span class="me-2" style="width: 100px;">{{lang.language_name}}</span>
                    <p-rating [ngModel]="getProficiencyRating(lang.proficiency)" [readonly]="true" />
                  </div>
                </div>
              </ng-container>
            </div>
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold mb-2">Soft Skills</div>
              <ng-container *ngFor="let skill of profileData?.careerPreference?.soft_skill_name">
                <div>{{skill}}</div>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Key Strengths Section -->
  <div class="card mb-4" *ngIf="profileData.careerPreference">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Key Strengths & Professional Traits</h3>
          <div class="mt-3 text-warning">Want to add more skills?</div>
          <button pButton label="Click here to add more to your list!" class="p-button-outlined p-button-warning mt-2"
            (click)="routingToPage('/pages/modules/skill-mastery')"></button>
        </div>
        <div class="col-md-9">
          <div class="mb-4">
            <div class="text-primary fw-bold">What sets you apart in your industry?</div>
            <p [innerHTML]="profileData.careerPreference.set_industry_apart || 'Not specified'"></p>
          </div>

          <div class="row">
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold">Have you solved a real-world challenge in your field?</div>
              <div>{{profileData.careerPreference.real_world_challenge || 'Not specified'}}</div>
            </div>
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold">Your top professional strength</div>
              <div *ngIf="profileData.careerPreference.professional_strength?.length > 0; else noProfessionalData">
                <div *ngFor="let item of profileData.careerPreference.professional_strength">
                  {{item}}
                </div>
              </div>
              <ng-template #noProfessionalData>Not specified</ng-template>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <div class="text-primary fw-bold">Have you taken on leadership roles?</div>
              <div>{{profileData.careerPreference.leadership_experience || 'Not specified'}}</div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="text-primary fw-bold">One quality others admire most about you</div>
              <div>{{profileData.careerPreference.admired_quality || 'Not specified'}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Professional Networking Section -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Professional Networking & Online Presence</h3>
        </div>
        <div class="col-md-9">
          <div class="row">
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold">LinkedIn Profile</div>
              <a [href]="profileData.linkedin_profile" target="_blank" class="text-break"
                *ngIf="profileData.linkedin_profile">
                <i class="pi pi-linkedin text-dark fs-4"></i>
              </a>
              <div *ngIf="!profileData.linkedin_profile" class="text-muted">Not specified</div>
            </div>
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold">Personal Website</div>
              <a [href]="profileData.personal_website" target="_blank" class="text-break"
                *ngIf="profileData.personal_website">
                <i class="pi pi-globe text-dark fs-4"></i>
              </a>
              <div *ngIf="!profileData.personal_website" class="text-muted">Not specified</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Attachments Section -->
  <div class="card mb-4" *ngIf="profileData.careerPreference">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Attachments & Media</h3>
          <div class="mt-3 text-warning">Want to update your CV?</div>
          <button pButton label="Click here to create or edit your resume!"
            class="p-button-outlined p-button-warning mt-2"
            (click)="routingToPage('/pages/job-tool/cv-builder')"></button>
        </div>
        <div class="col-md-9">
          <div class="row">
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold">Introduction Video</div>
              <div *ngIf="profileData.careerPreference.video_link; else noVideoLink">
                <a [href]="profileData.careerPreference.video_link" target="_blank" class="text-break">
                  <i class="pi pi-video text-dark fs-4"></i>
                </a>
              </div>
              <ng-template #noVideoLink>
                <div class="text-muted">Not specified</div>
              </ng-template>
            </div>
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold">Portfolio</div>
              <div *ngIf="profileData.careerPreference.portfolio_upload_link; else noUploadLink">
                <a [href]="profileData.careerPreference.portfolio_upload_link" target="_blank" class="text-break">
                  <i class="pi pi-link text-dark fs-4"></i>
                </a>
              </div>
              <ng-template #noUploadLink>
                <div class="text-muted">Not specified</div>
              </ng-template>
            </div>
            <div class="col-md-4 mb-3">
              <div class="text-primary fw-bold">Upload CV / Resume</div>
              <button *ngIf="profileData.careerPreference.cv_filename" pButton label="CV.pdf" icon="pi pi-download"
                class="p-button-outlined p-button-secondary w-100 justify-content-between" iconPos="right"></button>
              <div *ngIf="!profileData.careerPreference.cv_filename" class="text-muted">No CV uploaded</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- References Section -->
  <div class="card mb-4" *ngIf="profileData.references && profileData.references.length > 0">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">References & Endorsements</h3>
        </div>
        <div class="col-md-9">
          <div class="mb-4" *ngIf="profileData.references && profileData.references.length > 0">
            <div class="fw-bold fs-5 mb-3">Academic Reference</div>
            <div class="row" *ngFor="let ref of profileData.references">
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">College Name</div>
                <div>{{ref.college_name || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Reference Name</div>
                <div>{{ref.reference_name || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Designation</div>
                <div>{{ref.designation || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Email</div>
                <div>{{ref.email || 'Not specified'}}</div>
              </div>
            </div>
          </div>

          <div *ngIf="profileData.professional_references && profileData.professional_references.length > 0">
            <div class="fw-bold fs-5 mb-3">Professional Reference</div>
            <div class="row" *ngFor="let ref of profileData.professional_references">
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Organization Name</div>
                <div>{{ref.company_name || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Reference Name</div>
                <div>{{ref.reference_name || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Designation</div>
                <div>{{ref.designation || 'Not specified'}}</div>
              </div>
              <div class="col-md-4 col-xl-3 mb-3">
                <div class="text-primary fw-bold">Email</div>
                <div>{{ref.email || 'Not specified'}}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Additional Notes -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <h3 class="fw-bold text-navy">Additional Notes</h3>
        </div>
        <div class="col-md-9">
          <div class="row">
            <div class="col-12">
              <div [innerHTML]="profileData.careerPreference.notes">LinkedIn Profile</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>