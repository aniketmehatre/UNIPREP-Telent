<div class="card h-100 bg-white border-0">
	<div class="card-body overflow-y-auto p-0 border-0">
		<p-tabs [(value)]="activeTabValue" [scrollable]="true" styleClass="p-0" class="custom-tab" (onChange)="onTabChange($event)">
			<p-tablist>
				@for (tab of tabs; track tab.value) {
				<p-tab [value]="tab.value">
					{{ tab.label }}
				</p-tab>
				}
			</p-tablist>

			<p-tabpanels>
				@for (tab of tabs; track tab.value) {
				<p-tabpanel [value]="tab.value" class="p-0">
					<div class="row" *ngIf="companyList.length > 0">
						<div class="col-md-3 mb-2" *ngFor="let company of companyList">
							<div class="card mb-3 position-relative bg-white" role="button" (click)="onClickJobCard(company.id)">
								<div class="card-body d-flex align-items-center gap-2">
									<div class="w-100 border rounded-2 overflow-hidden" style="max-width: 65px; background-color: white; aspect-ratio: 1">
										<img [src]="company.company_logo" (error)="$event.target.src = '/uniprep-assets/images/job.webp'" class="w-100 h-100" style="object-fit: contain" alt="Company" />
									</div>
									<div class="job-details text-left">
										<h5 class="job-title mb-1 text-left">
											{{ company.company_name }}
										</h5>
										<div class="d-flex align-items-center location mb-2">
											<i class="pi pi-map-marker me-1 text-success"></i>
											<span>
												{{ company.HQ_city }},
												{{ company.HQ_country }}
											</span>
										</div>
										<span class="status-badge" [ngClass]="getStatusClass(company.status)">
											{{ company.status }}
										</span>
									</div>
									<span
										class="notification-badge position-absolute top-0 right-0"
										[ngClass]="{
											'bg-secondary-subtle text-white': !(company.notification_count > 0)
										}">
										{{ company?.notification_count || 0 }}
									</span>
								</div>
							</div>
						</div>
					</div>
				</p-tabpanel>
				}
			</p-tabpanels>
		</p-tabs>

		<ng-container *ngIf="!isSkeletonVisible && companyCount == 0">
			<div class="card-body d-flex flex-column align-items-center justify-content-center">
				<div class="mb-4">
					<i class="fa-solid fa-building uniprep-secondaryhighlight" style="font-size: 10rem"></i>
				</div>
				<ng-container *ngIf="isAppliedFilter && companyCount == 0; else showNoCompany">
					<h4 class="mb-3">No company match your search right now â€” try adjusting your criteria!</h4>
				</ng-container>
				<ng-template #showNoCompany>
					<h4 class="mb-3">No Company selected.</h4>
					<p class="text-muted mb-3">Please click on the company of your choice to view more information.</p>
				</ng-template>
			</div>
		</ng-container>
	</div>
	<div class="card-footer bg-transparent border-0">
		<div class="pagination-container d-flex justify-content-between align-items-center">
			<button class="btn btn-light" (click)="onBackClick()"><i class="pi pi-chevron-left me-1 fs-6"></i> Back</button>
			<span>Page {{ page }} / {{ totalPage }}</span>
			<button class="btn btn-light" (click)="onNextClick()">Next <i class="pi pi-chevron-right ms-1 fs-6"></i></button>
		</div>
	</div>
</div>
<app-company-filter [openModal]="displayModal" (closeFilter)="displayModal = false; triggerCloseFilter.emit()" (triggerApplyFiler)="applyFilter($event)" (resetFilter)="applyFilter({})" [isListView]="false" [currentTabIndex]="activeIndex"></app-company-filter>
