<div class="card readingcard bg-white">
	<div class="card-header border-0 bg-transparent">
		<div class="row justify-content-center">
			<div class="col-md-12 text-center">
				<div class="select-title d-flex justify-content-between align-items-center">
					<div>
						<h5 class="w-100 mb-1" tooltipPosition="top" pTooltip="Recommendations">RECOMMENDATIONS<i class="questiontooltip fa-solid fa-circle-question"></i></h5>
					</div>
					<div>
						<button pButton  class="how-it-works-button" severity="warn"  (click)="openVideoPopup()">How it works?<i class="fa-solid fa-play d-md-block d-none"></i></button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="card-body text-center flex-fill overflow-y-auto">
		<div class="container-fluid h-100">
			<p-carousel  [value]="products" [numVisible]="1" [numScroll]="1" [circular]="false" [showNavigators]="false" [showIndicators]="false" [page]="activePageIndex" styleClass="h-100 w-100" *ngIf="!enableModule">
				<ng-template let-product let-i="index" pTemplate="item">
					<div class="h-100 d-flex flex-column justify-content-between">
						<div>&nbsp;</div>
						<div class="row justify-content-center text-start">
							<div class="col-md-12 mb-4">
								<h5 class="text-center uniprep-primary fw-semibold mb-0">Question Number {{ product.id }}</h5>
								<h2 class="fw-bold mb-0 text-center">{{ product.question }}</h2>
							</div>
							<div class="col-md-4">
								<div class="recommendationinput d-flex flex-column justify-content-center gap-3">
									<div class="flex gap-3 align-items-center border-primary rounded px-2 py-3">
										<p-radioButton id="yes_{{ product.id }}" [ngClass]="{ 'ng-invalid ng-dirty': invalidClass === true }" name="selection_{{ product.id }}" [value]="true" (onClick)="onClickRadioButton()" [(ngModel)]="selectedData[product.id]"> </p-radioButton>
										<label class="fw-semibold" for="yes_{{ product.id }}">Yes</label>
									</div>
									<div class="flex gap-3 align-items-center border-primary rounded px-2 py-3">
										<p-radioButton id="no_{{ product.id }}" [ngClass]="{ 'ng-invalid ng-dirty': invalidClass === true }" (onClick)="onClickRadioButton()" name="selection_{{ product.id }}" [value]="false" [(ngModel)]="selectedData[product.id]"> </p-radioButton>
										<label class="fw-semibold" for="no_{{ product.id }}">No</label>
									</div>
									<p class="text-center text-danger" [ngClass]="{ 'd-none': invalidClass === false }">Please Choose Any one option</p>
								</div>
							</div>
						</div>
						<div class="d-flex justify-content-between mt-2">
							<button pButton type="button" [style.visibility]="product.id == 1 ? 'hidden' : 'visible'" class="btn btn-primary btn-rounded p-1 pe-4" (click)="previous(product.id)">
								<span class="btn-icon px-2 py-2"><i class="fa fa-arrow-left"></i></span> <span class="ms-2">Previous</span>
							</button>
							<button pButton type="button" *ngIf="product.id != 4" class="btn btn-primary btn-rounded p-1 ps-4" (click)="next(product.id)">
								<span class="me-2">Next</span><span class="btn-icon px-2 py-2"><i class="fa fa-arrow-right"></i></span>
							</button>
							<button pButton type="button" *ngIf="product.id == 4" class="btn btn-success btn-rounded p-1 ps-4" (click)="getRecommendation(product.id)" severity="success">
								<span class="me-2">Get Recommendations</span><span class="btn-icon px-2 py-2"><i class="fa fa-check-circle"></i></span>
							</button>
						</div>
					</div>
				</ng-template>
			</p-carousel>

			<div class="container" *ngIf="enableModule">
				<div class="row justify-content-center mb-4">
					<div class="col-md-12">
						<div class="card recommendationcard">
							<div class="card-body px-4 py-4">
								<div class="row">
									<div class="col-8 text-start">
										<h5 class="mb-0" *ngIf="recommended?.planname != 'no'">We recommend the {{ recommended?.planname }} plan based on your choices.Subscribe or Upgrade your plan to enjoy our services.</h5>
										<h5 class="mb-0" *ngIf="recommended?.planname == 'no'">We recommend {{ recommended?.planname }} plan based on your choices.</h5>
									</div>
									<div class="col-4 text-end">
										<button pButton type="button" *ngIf="recommended?.planname != 'no'" (click)="subscribeNow()" class="btn bg-white text-black btn-rounded">Subscribe Now</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<ng-container *ngIf="recommended && recommended.recommends && recommended.recommends.length">
					<div *ngFor="let recommendList of recommended.recommends">
						<h5 class="text-center p-2" *ngIf="recommended?.planname != 'no'">Recommended {{ recommendList?.name }} Modules</h5>
						<h5 class="text-center p-2" *ngIf="recommended?.planname == 'no'">UNIPREP is not the right fit for you.</h5>
						<div class="row justify-content-center" *ngIf="recommendList.details && recommendList.details.length">
							<div class="col-md-2" *ngFor="let modulesList of recommendList.details">
								<div class="card recommendationitemcard mb-3" role="button" (click)="moduleRedirect(modulesList.module_link)">
									<div class="card-body">
										<img src="{{ modulesList.image_link }}" class="img-fluid mb-3" alt="Module Image" />
										<h5 class="mb-0">{{ modulesList.name }}</h5>
									</div>
								</div>
							</div>
						</div>
					</div>
				</ng-container>
			</div>
			<router-outlet></router-outlet>
		</div>
	</div>
	<div class="card-footer border-0 bg-transparent" *ngIf="enableModule">
		<div class="row mb-2">
			<div class="col-md-12 text-end">
				<button pButton type="button" class="btn btn-quit ps-3 btn-rounded" (click)="resetRecommendation()">
					Reset Recommendations<span class="btn-icon"><i class="fa-solid fa-undo"></i> </span>
				</button>
			</div>
		</div>
	</div>
</div>
